
# Increase Upload Limits for Video
php_value upload_max_filesize 128M
php_value post_max_size 128M
php_value memory_limit 256M
php_value max_execution_time 300
php_value max_input_time 300

<IfModule mod_rewrite.c>
    Options -MultiViews
    RewriteEngine On
    # Adjust RewriteBase: Use /zensshop/ for local WAMP Www directory
    # IMPORTANT: Change this to / if your live site is at the root domain (e.g. zensshop.com)
    RewriteBase /zensshop/
    ErrorDocument 404 /zensshop/not-found

    # Custom Clean URLs (Masking)
    # 1. External Redirects: Force nice URLs (changes browser address bar)
    RewriteCond %{THE_REQUEST} \s/admin/homepage_categories_settings [NC]
    RewriteRule ^ /admin/category [R=301,L]
    RewriteCond %{THE_REQUEST} \s/admin/banner_settings [NC]
    RewriteRule ^ /admin/banner [R=301,L]
    RewriteCond %{THE_REQUEST} \s/admin/features_settings [NC]
    RewriteRule ^ /admin/features [R=301,L]
    RewriteCond %{THE_REQUEST} \s/admin/footer_info [NC]
    RewriteRule ^ /admin/footer [R=301,L]
    RewriteCond %{THE_REQUEST} \s/admin/header_info [NC]
    RewriteRule ^ /admin/header [R=301,L]
    RewriteCond %{THE_REQUEST} \s/admin/homepage_products_settings [NC]
    RewriteRule ^ /admin/products [R=301,L]
    RewriteCond %{THE_REQUEST} \s/admin/homepage_videos_settings [NC]
    RewriteRule ^ /admin/shorts [R=301,L]
    RewriteCond %{THE_REQUEST} \s/admin/menu_settings [NC]
    RewriteRule ^ /admin/menu [R=301,L]
    RewriteCond %{THE_REQUEST} \s/admin/newsletter_settings [NC]
    RewriteRule ^ /admin/newsletter [R=301,L]
    RewriteCond %{THE_REQUEST} \s/admin/philosophy_settings [NC]
    RewriteRule ^ /admin/philosophy [R=301,L]
    RewriteCond %{THE_REQUEST} \s/admin/special_offers_settings [NC]
    RewriteRule ^ /admin/offers [R=301,L]
    RewriteCond %{THE_REQUEST} \s/admin/system-settings [NC]
    RewriteRule ^ /admin/settings [R=301,L]

    # 2. Internal Rewrites: Map nice URLs to PHP files
    RewriteRule ^admin/category$ admin/homepage_categories_settings.php [L,QSA]
    RewriteRule ^admin/banner$ admin/banner_settings.php [L,QSA]
    RewriteRule ^admin/features$ admin/features_settings.php [L,QSA]
    RewriteRule ^admin/footer$ admin/footer_info.php [L,QSA]
    RewriteRule ^admin/reset$ admin/forgot-password.php [L,QSA]
    RewriteRule ^admin/header$ admin/header_info.php [L,QSA]
    RewriteRule ^admin/products/?$ admin/homepage_products_settings.php [L,QSA]
    RewriteRule ^admin/shorts$ admin/homepage_videos_settings.php [L,QSA]
    RewriteRule ^admin/menu$ admin/menu_settings.php [L,QSA]
    RewriteRule ^admin/newsletter$ admin/newsletter_settings.php [L,QSA]
    RewriteRule ^admin/philosophy$ admin/philosophy_settings.php [L,QSA]
    RewriteRule ^admin/offers$ admin/special_offers_settings.php [L,QSA]
    RewriteRule ^admin/special-page$ admin/settings.php [L,QSA]
    RewriteRule ^admin/settings$ admin/system-settings.php [L,QSA]
    
    # Blog Detail Page
    RewriteRule ^blog/([a-zA-Z0-9-_]+)$ blog-post.php?slug=$1 [QSA,L]

    # 1. Externally redirect /file.php to /file (Client Request -> Browser URL change)
    # This ensures that even if code links to 'contact.php', the user sees 'contact'
    # Exclude POST requests to prevent 405 errors on form submission (preserving POST data)
    RewriteCond %{REQUEST_METHOD} !POST
    RewriteCond %{THE_REQUEST} \s/+(.+?)\.php[\s?] [NC]
    RewriteRule ^ /%1 [R=301,L,NE]

    # 2. Internally rewrite extensionless URLs to .php files (Server internal processing)
    # This allows the server to find 'contact.php' when 'contact' is requested
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME}.php -f
    RewriteRule ^([^\.]+)$ $1.php [NC,L]

    # 3. Don't rewrite actual files or directories
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    
# 5. Enable Gzip Compression
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE image/svg+xml
</IfModule>

# 6. Enable Browser Caching (Leverage Browser Caching)
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    ExpiresByType image/x-icon "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/pdf "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/x-javascript "access plus 1 month"
    ExpiresByType application/x-shockwave-flash "access plus 1 month"
    ExpiresDefault "access plus 2 days"
</IfModule>

# 4. Dynamic Router - Check if it's a custom page, blog, or landing page
# This will route to router.php which will determine the correct handler
RewriteRule ^([a-zA-Z0-9-_]+)$ router.php?slug=$1 [QSA,L]
</IfModule>