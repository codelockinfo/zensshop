const sections=[{id:"categories-section",endpoint:"categories"},{id:"best-selling-section",endpoint:"best-selling"},{id:"special-offers-section",endpoint:"special-offers"},{id:"videos-section",endpoint:"videos"},{id:"trending-section",endpoint:"trending"},{id:"philosophy-section",endpoint:"philosophy"},{id:"features-section",endpoint:"features"},{id:"newsletter-section",endpoint:"newsletter"}];let currentSectionIndex=0;function loadNextSection(){if(currentSectionIndex>=sections.length)return;let e=sections[currentSectionIndex];loadSection(e.id,e.endpoint),currentSectionIndex++}async function loadSection(e,t){let n=document.getElementById(e);if(!n)return;let i=localStorage.getItem("cookieConsent"),r=`cached_section_${t}`;if("allowed"===i){let l=localStorage.getItem(r);if(l){n.innerHTML=l,n.classList.remove("section-loading"),n.classList.add("fade-in"),initializeSection(n),setTimeout(()=>{loadNextSection()},100),fetchFreshSection(t,r,!1);return}}await fetchFreshSection(t,r,!0,n)}async function fetchFreshSection(e,t,n,i=null){try{let r="undefined"!=typeof BASE_URL?BASE_URL:window.location.pathname.split("/").slice(0,-1).join("/")||"",l=await fetch(`${r}/api/sections.php?section=${e}`),o=await l.text();o?("allowed"===localStorage.getItem("cookieConsent")&&localStorage.setItem(t,o),n&&i&&(i.innerHTML=o,i.classList.remove("section-loading"),i.classList.add("fade-in"),initializeSection(i),setTimeout(()=>{loadNextSection()},300))):n&&i&&(i.style.display="none",i.classList.remove("section-loading"),setTimeout(()=>{loadNextSection()},100))}catch(s){console.error(`Error loading section ${e}:`,s),n&&i&&(i.innerHTML='<div class="text-center py-8 text-red-500">Error loading section</div>',i.classList.remove("section-loading"),setTimeout(()=>{loadNextSection()},300))}}function initializeSection(e){let t=e.querySelectorAll(".add-to-cart-btn");t.forEach(e=>{let t=e.getAttribute("data-product-id");t&&e.addEventListener("click",function(e){e.preventDefault(),addToCart(parseInt(t),1)})}),("best-selling-section"===e.id||e.querySelector("#bestSellingSlider"))&&setTimeout(function(){initializeBestSellingSlider()},200),("trending-section"===e.id||e.querySelector("#trendingSlider"))&&setTimeout(function(){initializeTrendingSlider()},200),("videos-section"===e.id||e.querySelector(".video-card"))&&setTimeout(function(){initializeVideos()},100),e.querySelector(".product-card")&&setTimeout(function(){"function"==typeof initializeProductCards&&initializeProductCards()},200),("newsletter-section"===e.id||e.querySelector("#globalNewsletterForm"))&&initializeNewsletterForm(e)}function initializeNewsletterForm(e){let t=e.querySelector("#globalNewsletterForm");if(!t)return;let n=t.cloneNode(!0);t.parentNode.replaceChild(n,t),n.addEventListener("submit",async function(e){e.preventDefault(),console.log("Global Newsletter Form Submitted");let t=this.querySelector('button[type="submit"]'),n=t.innerText,i=document.getElementById("globalNewsletterMessage");t.innerText="Subscribing...",t.disabled=!0,i&&i.classList.add("hidden");let r=this.querySelector('input[name="email"]').value;try{let l="undefined"!=typeof BASE_URL?BASE_URL:window.location.pathname.split("/").slice(0,-1).join("/")||"",o=await fetch(l+"/api/subscribe.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})}),s=await o.json();s.success?(this.reset(),i&&(i.textContent=s.message||"Successfully subscribed!",i.className="text-center text-sm text-green-600 bg-green-50 py-2 px-4 rounded",i.classList.remove("hidden"),setTimeout(()=>{i.classList.add("hidden")},5e3))):i&&(i.textContent=s.message||"Something went wrong. Please try again.",i.className="text-center text-sm text-red-600 bg-red-50 py-2 px-4 rounded",i.classList.remove("hidden"),setTimeout(()=>{i.classList.add("hidden")},5e3))}catch(d){console.error(d),i&&(i.textContent="An error occurred. Please try again.",i.className="text-center text-sm text-red-600 bg-red-50 py-2 px-4 rounded",i.classList.remove("hidden"),setTimeout(()=>{i.classList.add("hidden")},5e3))}finally{t.innerText=n,t.disabled=!1}})}function initializeVideos(){let e=document.querySelectorAll(".video-card video");e.forEach(e=>{e.setAttribute("autoplay",""),e.setAttribute("loop",""),e.setAttribute("muted",""),e.setAttribute("playsinline",""),e.play().catch(function(e){}),e.addEventListener("loadeddata",function(){e.play().catch(()=>{})})}),setTimeout(function(){let e=document.getElementById("videoSectionSlider"),t=e?e.parentElement:null,n=document.getElementById("videoSectionPrev"),i=document.getElementById("videoSectionNext");if(!e||!n||!i||"true"===e.dataset.initialized)return;e.dataset.initialized="true";let r=0,l=!1,o=0,s=0,d=0,a=0,c=null,u=null;function $(){return window.innerWidth>=1024?4:window.innerWidth>=640?2:1}function f(){if(!e.children.length)return 0;let t=e.children[0];if(!t)return 0;let n=t.offsetWidth,i=window.getComputedStyle(e),r=parseFloat(i.gap)||24,l=e.parentElement.offsetWidth,o=e.scrollWidth;return o<=l+5?0:Math.max(0,e.children.length-Math.floor((l+r)/(n+r)))}function h(t=!1){if(!e.children.length)return;let n=e.children[0];if(!n)return;let i=n.offsetWidth,o=window.getComputedStyle(e),s=parseFloat(o.gap)||24,d=e.parentElement.offsetWidth,$=e.scrollWidth,h=f();r>h&&(r=h),r<0&&(r=0);let p;p=r===h&&h>0?d-$:-r*(i+s),p+=l?a:0,e.style.transform=`translateX(${p}px)`,t?e.style.transition="none":e.style.transition="transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)";let g=c||document.getElementById("videoSectionPrev"),m=u||document.getElementById("videoSectionNext");g&&(g.style.display=r>0?"flex":"none"),m&&(m.style.display=r<h?"flex":"none")}function p(e){return e.type.includes("mouse")?e.clientX:e.touches[0].clientX}function g(n){if(n.target.closest("a, button"))return;l=!0,o=p(n);let i=e.children[0],s=i&&i.offsetWidth||300;d=-r*(s+24),a=0,t&&(t.style.cursor="grabbing",t.style.userSelect="none"),"touchstart"===n.type?(document.addEventListener("touchmove",m,{passive:!1}),document.addEventListener("touchend",v)):(document.addEventListener("mousemove",m),document.addEventListener("mouseup",v))}function m(t){if(!l)return;t.preventDefault(),s=p(t);let n=s-o;a=n,e.style.transition="none",h(!0)}function v(n){if(!l)return;document.removeEventListener("touchmove",m),document.removeEventListener("touchend",v),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",v),l=!1,t&&(t.style.cursor="grab",t.style.userSelect="");let i=e.children[0],o=i?i.offsetWidth:300;Math.abs(a)>.25*o&&(a<0&&r<f()?r++:a>0&&r>0&&r--),a=0,h()}if(n&&i){let y=n.cloneNode(!0),E=i.cloneNode(!0);n.parentNode.replaceChild(y,n),i.parentNode.replaceChild(E,i),c=y,u=E,y.addEventListener("click",e=>{e.preventDefault(),r>0&&(r--,h())}),E.addEventListener("click",e=>{e.preventDefault(),r<f()&&(r++,h())})}t&&(t.style.cursor="grab",t.addEventListener("touchstart",g,{passive:!1}),t.addEventListener("mousedown",g)),window.addEventListener("resize",()=>{setTimeout(h,250)}),h()},200)}function initializeBestSellingSlider(){setTimeout(function(){let e=document.getElementById("bestSellingSlider"),t=e?e.parentElement:null,n=document.getElementById("bestSellingPrev"),i=document.getElementById("bestSellingNext");if(!e){console.log("Best selling slider not found");return}if(!n||!i){console.log("Best selling navigation buttons not found");return}if("true"===e.dataset.initialized)return;e.dataset.initialized="true";let r=0,l=!1,o=0,s=0,d=0,a=0,c=null,u=null;function $(){return window.innerWidth>=1280?6:window.innerWidth>=1024?4:window.innerWidth>=640?2:1}function f(){if(!e.children.length)return 0;let t=e.children[0];if(!t)return 0;let n=t.offsetWidth,i=window.getComputedStyle(e),r=parseFloat(i.gap)||24,l=e.parentElement.offsetWidth,o=e.scrollWidth;return o<=l+5?0:Math.max(0,e.children.length-Math.floor((l+r)/(n+r)))}function h(t=!1){if(!e.children.length)return;let n=e.children[0];if(!n)return;let i=n.offsetWidth,o=window.getComputedStyle(e),s=parseFloat(o.gap)||24,d=e.parentElement.offsetWidth,$=e.scrollWidth,h=f();r>h&&(r=h),r<0&&(r=0);let p;p=r===h&&h>0?d-$:-r*(i+s);let g=p+(l?a:0);e.style.transform=`translateX(${g}px)`,t?e.style.transition="none":e.style.transition="transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)";let m=c||document.getElementById("bestSellingPrev"),v=u||document.getElementById("bestSellingNext");m&&(m.style.display=r>0?"flex":"none"),v&&(v.style.display=r<h?"flex":"none")}function p(e){return e.type.includes("mouse")?e.clientX:e.touches[0].clientX}function g(n){let i=n.target.closest("a, button, .wishlist-btn, .product-action-btn");if(i)return;l=!0,o=p(n);let s=e.children[0];if(!s){l=!1;return}let c=s.offsetWidth||300;d=-r*(c+24),a=0,t&&(t.style.cursor="grabbing",t.style.userSelect="none"),"touchstart"===n.type?(document.addEventListener("touchmove",m,{passive:!1}),document.addEventListener("touchend",v)):(document.addEventListener("mousemove",m),document.addEventListener("mouseup",v))}function m(t){if(!l)return;t.preventDefault(),t.stopPropagation(),s=p(t);let n=s-o,i=e.children[0];if(!i)return;let r=i.offsetWidth||300,c=f(),u=-c*(r+24);a=n;let $=d+a;$>0?a=0-d:$<u&&(a=u-d),e.style.transition="none",h(!0)}function v(n){if(!l)return;document.removeEventListener("touchmove",m),document.removeEventListener("touchend",v),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",v),l=!1,t&&(t.style.cursor="grab",t.style.userSelect="");let i=e.children[0];if(!i){a=0,h();return}let o=i.offsetWidth||300;Math.abs(a)>.25*o&&(a<0&&r<f()?r++:a>0&&r>0&&r--),a=0,h()}if(n&&i){let y=n.cloneNode(!0),E=i.cloneNode(!0);n.parentNode.replaceChild(y,n),i.parentNode.replaceChild(E,i),c=y,u=E,y.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r>0&&(r--,h())}),E.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r<f()&&(r++,h())})}t&&(t.style.cursor="grab",t.addEventListener("touchstart",g,{passive:!1}),t.addEventListener("mousedown",g));let S,b=function(){clearTimeout(S),S=setTimeout(function(){h()},250)};window.addEventListener("resize",b);let L=e.querySelectorAll("img"),x=0;0===L.length?h():L.forEach(function(e){e.complete?++x===L.length&&h():(e.addEventListener("load",function(){++x===L.length&&h()}),e.addEventListener("error",function(){++x===L.length&&h()}))}),setTimeout(h,500)},300)}function initializeTrendingSlider(){setTimeout(function(){let e=document.getElementById("trendingSlider"),t=e?e.parentElement:null,n=document.getElementById("trendingPrev"),i=document.getElementById("trendingNext");if(!e){console.log("Trending slider not found");return}if(!n||!i){console.log("Trending navigation buttons not found");return}if("true"===e.dataset.initialized)return;e.dataset.initialized="true";let r=0,l=!1,o=0,s=0,d=0,a=0,c=null,u=null;function $(){return window.innerWidth>=1280?6:window.innerWidth>=1024?4:window.innerWidth>=640?2:1}function f(){if(!e.children.length)return 0;let t=e.children[0];if(!t)return 0;let n=t.offsetWidth,i=window.getComputedStyle(e),r=parseFloat(i.gap)||24,l=e.parentElement.offsetWidth,o=e.scrollWidth;return o<=l+5?0:Math.max(0,e.children.length-Math.floor((l+r)/(n+r)))}function h(t=!1){if(!e.children.length)return;let n=e.children[0];if(!n)return;let i=n.offsetWidth,o=window.getComputedStyle(e),s=parseFloat(o.gap)||24,d=e.parentElement.offsetWidth,$=e.scrollWidth,h=f();r>h&&(r=h),r<0&&(r=0);let p;p=r===h&&h>0?d-$:-r*(i+s);let g=p+(l?a:0);e.style.transform=`translateX(${g}px)`,t?e.style.transition="none":e.style.transition="transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)";let m=c||document.getElementById("trendingPrev"),v=u||document.getElementById("trendingNext");m&&(m.style.display=r>0?"flex":"none"),v&&(v.style.display=r<h?"flex":"none")}function p(e){return e.type.includes("mouse")?e.clientX:e.touches[0].clientX}function g(n){let i=n.target.closest("a, button, .wishlist-btn, .product-action-btn");if(i)return;l=!0,o=p(n);let s=e.children[0];if(!s){l=!1;return}let c=s.offsetWidth||300;d=-r*(c+24),a=0,t&&(t.style.cursor="grabbing",t.style.userSelect="none"),"touchstart"===n.type?(document.addEventListener("touchmove",m,{passive:!1}),document.addEventListener("touchend",v)):(document.addEventListener("mousemove",m),document.addEventListener("mouseup",v))}function m(t){if(!l)return;t.preventDefault(),t.stopPropagation(),s=p(t);let n=s-o,i=e.children[0];if(!i)return;let r=i.offsetWidth||300,c=f(),u=-c*(r+24);a=n;let $=d+a;$>0?a=0-d:$<u&&(a=u-d),e.style.transition="none",h(!0)}function v(n){if(!l)return;document.removeEventListener("touchmove",m),document.removeEventListener("touchend",v),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",v),l=!1,t&&(t.style.cursor="grab",t.style.userSelect="");let i=e.children[0];if(!i){a=0,h();return}let o=i.offsetWidth||300;Math.abs(a)>.25*o&&(a<0&&r<f()?r++:a>0&&r>0&&r--),a=0,h()}if(n&&i){let y=n.cloneNode(!0),E=i.cloneNode(!0);n.parentNode.replaceChild(y,n),i.parentNode.replaceChild(E,i),c=y,u=E,y.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r>0&&(r--,h())}),E.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r<f()&&(r++,h())})}t&&(t.style.cursor="grab",t.addEventListener("touchstart",g,{passive:!1}),t.addEventListener("mousedown",g));let S,b=function(){clearTimeout(S),S=setTimeout(function(){h()},250)};window.addEventListener("resize",b);let L=e.querySelectorAll("img"),x=0;0===L.length?h():L.forEach(function(e){e.complete?++x===L.length&&h():(e.addEventListener("load",function(){++x===L.length&&h()}),e.addEventListener("error",function(){++x===L.length&&h()}))}),setTimeout(h,500)},300)}document.addEventListener("DOMContentLoaded",function(){setTimeout(()=>{loadNextSection()},500)});